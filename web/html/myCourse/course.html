<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="../../lib/bootstrap/css/bootstrap.css">
    <link rel="stylesheet" href="../../lib/bootstrap-table/bootstrap-table.css">
    <link rel="stylesheet" href="../../static/h-ui.admin/css/iconStyle.css" />
    <link rel="stylesheet" href="../../static/h-ui.admin/css/public.css" />
    <style>
        .btn{padding: 2px 4px}
    </style>
</head>
<body>
    <div class="IndexRight">
        <h6 class="page_title">
            <img src="../../images/module_title.png">
            <!--<span>课程列表</span>-->
            <span>使用列表</span>
        </h6>
        <div class="panel panel-default panel-success">
            <div class="panel-heading">
                <span>您本学年已经通过的课程</span>
                <span style="position: absolute;right: 30px">
                    <button id="addCurse" type="button" class="btn btn-primary">申请使用<!--申请上课--></button>
                </span>
            </div>
            <div class="panel-body">
                <table id="tableTop" data-toggle="table" table-no-bordered="false"  data-toggle="table"  data-method="post" data-toolbar="#toolbar" data-pagination="true"  data-page-list="[5,10,15]" data-unique-id="id" data-page-size="10">
                    <thead>
                    <tr>
                        <th data-field="curriculum_num" data-align="center">课程号</th>
                        <th data-formatter="curriculum_name" data-align="center">课程名称</th>
                        <th data-field="college_name" data-align="center">开课院系</th>
                        <th data-formatter="curriculumState" data-align="center">课程状态</th>
                    </tr>
                    </thead>
                </table>
            </div>
        </div>
        <div class="panel panel-default panel-info">
            <div class="panel-heading">审核中的课程</div>
            <div class="panel-body">
                <table id="tableDom" data-toggle="table" table-no-bordered="false"  data-toggle="table"  data-method="post" data-toolbar="#toolbar" data-pagination="true"  data-page-list="[5,10,15]" data-unique-id="id" data-page-size="10">
                    <thead>
                    <tr>
                        <th data-field="curriculum_num" data-align="center">课程号</th>
                        <th data-field="curriculum_name" data-align="center">课程名称</th>
                        <th data-field="user_name" data-align="center">主讲教师</th>
                        <th data-field="college_name" data-align="center">开课院系</th>
                        <th data-field="status" data-formatter="thAlready" data-align="center">课程状态</th>
                    </tr>
                    </thead>
                </table>
            </div>
        </div>
        <div class="panel panel-default panel-danger">
            <div class="panel-heading">审核未通过的课程</div>
            <div class="panel-body">
                <table id="tableDoms" data-toggle="table" table-no-bordered="false"  data-toggle="table"  data-method="post" data-toolbar="#toolbar" data-pagination="true"  data-page-list="[5,10,15]" data-unique-id="id" data-page-size="10">
                    <thead>
                    <tr>
                        <th data-field="curriculum_num" data-align="center">课程号</th>
                        <th data-field="curriculum_name" data-align="center">课程名称</th>
                        <th data-field="user_name" data-align="center">主讲教师</th>
                        <th data-field="college_name" data-align="center">开课院系</th>
                        <th data-field="status" data-formatter="thAlready" data-align="center">课程状态</th>
                    </tr>
                    </thead>
                </table>
            </div>
        </div>
    </div>
</body>
<script type="text/javascript" src="../../lib/jquery/3.1.1/jquery-3.1.1.min.js"></script>
<script type="text/javascript" src="../../lib/bootstrap/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../../lib/bootstrap-table/bootstrap-table.js"></script>
<script type="text/javascript" src="../../lib/bootstrap-table/locale/bootstrap-table-zh-CN.js"></script>
<script>
    $("#addCurse").click(function () {
        var $ifrem = window.parent.document.getElementById("iframe");
        $($ifrem).attr("src","html/myCourse/addStartclass.html")
    });
    //加载我的课程已通过课程
    $.ajax({
        type:'get',
        url:'/api/teachApplyCheckedList',
        dataType:'json',
        success:function (data) {
            if(data.code=="001"){
                var $table = $('#tableTop');
                var datas = data.result;
                $table.bootstrapTable('load',datas);
            } else {
                layer.msg(data.message,{icon:2});
            }
        },
        error:function(err){
            console.error(err);
        }
    });
    function curriculum_name(value, row, index) {
        return [
            '<span onclick="openJump(\''+ row.id + '\',\'' +row.curriculum_id+ '\')" style="cursor: pointer"  title="' +row.curriculum_name+ '">' +row.curriculum_name+ '</span>'
        ].join('');
    }
    function openJump(id,ids) {
        window.open("../../childIndex.html?id=" + id + "&ids=" + ids);
    }
    function curriculumState(value, row, index) {
        if(row.status == '1') {
            return [
                '<span style="color: green"  title="">正常</span>'
            ].join('');
        }
    }
    //加载我的课程审核中的课程
    $.ajax({
        type:'get',
        url:'/api/teachApplyWaitCheckList',
        dataType:'json',
        success:function (data) {
            if(data.code=="001"){
                var $table = $('#tableDom');
                var datas = data.result;
                $table.bootstrapTable('load',datas);
            } else {
                layer.msg(data.message,{icon:2});
            }
        },
        error:function(err){
            console.error(err);
        }
    });
    function thAlready(value, row, index) {
        if(row.status == '0') {
            return [
                '<span style="color: #2E6DA4"  title="">待审核</span>'
            ].join('');
        }else if(row.status == '1') {
            return [
                '<span style="color: green"  title="">审核通过</span>'
            ].join('');
        } else if(row.status == '2') {
            return [
                '<span style="color: red"  title="">审核未通过</span>'
            ].join('');
        }

    }

    //加载我的课程未通过审核的课程
    $.ajax({
        type:'get',
        url:'/api/teachApplyUnAccessCheckList',
        dataType:'json',
        success:function (data) {
            if(data.code=="001"){
                var $table = $('#tableDoms');
                var datas = data.result;
                $table.bootstrapTable('load',datas);
            } else {
                layer.msg(data.message,{icon:2});
            }
        },
        error:function(err){
            console.error(err);
        }
    });


</script>
</html>